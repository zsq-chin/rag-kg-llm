â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                   Tianshu (å¤©æ¢) - Docker å¿«é€Ÿå…¥é—¨æŒ‡å—                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ ç›®å½•
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. å‰ç½®è¦æ±‚
2. å¿«é€Ÿéƒ¨ç½²ï¼ˆ3 ç§æ–¹å¼ï¼‰
3. è®¿é—®æœåŠ¡
4. å¸¸ç”¨å‘½ä»¤
5. æ•…éšœæ’æŸ¥
6. ç”Ÿäº§ç¯å¢ƒå»ºè®®

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1ï¸âƒ£ å‰ç½®è¦æ±‚
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… å¿…éœ€ï¼š
  â€¢ Docker 20.10+          (https://docs.docker.com/get-docker/)
  â€¢ Docker Compose 2.0+    (é€šå¸¸éš Docker ä¸€èµ·å®‰è£…)
  â€¢ 16GB+ RAM
  â€¢ 50GB+ å¯ç”¨ç£ç›˜ç©ºé—´

â­ GPU æ”¯æŒï¼ˆæ¨èï¼‰ï¼š
  â€¢ NVIDIA GPU (CUDA Compute Capability 6.0+)
  â€¢ NVIDIA Driver 520.06+
  â€¢ NVIDIA Container Toolkit
    å®‰è£…: https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/

ğŸ” éªŒè¯å®‰è£…ï¼š
  docker --version
  docker-compose --version
  nvidia-smi  # GPU æ”¯æŒ

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

2ï¸âƒ£ å¿«é€Ÿéƒ¨ç½²ï¼ˆ3 ç§æ–¹å¼ï¼‰
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

æ–¹å¼ Aï¼šä½¿ç”¨ Makefileï¼ˆæ¨èï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # ä¸€é”®éƒ¨ç½²
  make setup

  # æŸ¥çœ‹å¸®åŠ©
  make help

æ–¹å¼ Bï¼šä½¿ç”¨å¿«é€Ÿéƒ¨ç½²è„šæœ¬
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Linux/Mac:
    cd scripts
    chmod +x docker-setup.sh
    ./docker-setup.sh

  Windows:
    cd scripts
    docker-setup.bat

æ–¹å¼ Cï¼šæ‰‹åŠ¨éƒ¨ç½²
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # 1. é…ç½®ç¯å¢ƒå˜é‡
  cp .env.example .env
  # ç¼–è¾‘ .envï¼Œä¿®æ”¹ JWT_SECRET_KEY

  # 2. åˆ›å»ºå¿…è¦ç›®å½•
  mkdir -p models data/uploads data/output data/db logs/{backend,worker,mcp}

  # 3. æ„å»ºé•œåƒ
  docker-compose build --parallel

  # 4. å¯åŠ¨æœåŠ¡
  docker-compose up -d

  # 5. æŸ¥çœ‹çŠ¶æ€
  docker-compose ps

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

3ï¸âƒ£ è®¿é—®æœåŠ¡
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

æœåŠ¡å¯åŠ¨åï¼Œè®¿é—®ä»¥ä¸‹åœ°å€ï¼š

  ğŸŒ å‰ç«¯ç•Œé¢:  http://localhost:80
  ğŸ“š API æ–‡æ¡£:  http://localhost:8000/docs
  âš™ï¸  Worker:    http://localhost:8001
  ğŸ”Œ MCP:       http://localhost:8002

âš ï¸ é¦–æ¬¡è¿è¡Œæ³¨æ„äº‹é¡¹ï¼š
  â€¢ AI æ¨¡å‹ä¼šè‡ªåŠ¨ä¸‹è½½ï¼Œå¯èƒ½éœ€è¦ 10-30 åˆ†é’Ÿ
  â€¢ é¦–æ¬¡å¯åŠ¨è¾ƒæ…¢ï¼Œè¯·è€å¿ƒç­‰å¾…
  â€¢ éœ€è¦é€šè¿‡æ³¨å†Œé¡µé¢åˆ›å»ºç®¡ç†å‘˜è´¦å·

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

4ï¸âƒ£ å¸¸ç”¨å‘½ä»¤
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ä½¿ç”¨ Makefileï¼ˆæ¨èï¼‰ï¼š
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  make start              # å¯åŠ¨æœåŠ¡
  make stop               # åœæ­¢æœåŠ¡
  make restart            # é‡å¯æœåŠ¡
  make status             # æŸ¥çœ‹çŠ¶æ€
  make logs               # æŸ¥çœ‹æ—¥å¿—
  make logs-backend       # æŸ¥çœ‹åç«¯æ—¥å¿—
  make test-gpu           # æµ‹è¯• GPU
  make shell-backend      # è¿›å…¥åç«¯å®¹å™¨
  make clean              # æ¸…ç†æ•°æ®

ä½¿ç”¨ docker-composeï¼š
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  docker-compose up -d              # å¯åŠ¨
  docker-compose down               # åœæ­¢
  docker-compose restart            # é‡å¯
  docker-compose ps                 # çŠ¶æ€
  docker-compose logs -f            # æ—¥å¿—
  docker-compose logs -f backend    # åç«¯æ—¥å¿—
  docker-compose exec backend bash  # è¿›å…¥å®¹å™¨

å¼€å‘ç¯å¢ƒï¼š
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  make dev                # å¯åŠ¨å¼€å‘ç¯å¢ƒ
  make dev-stop           # åœæ­¢å¼€å‘ç¯å¢ƒ
  make dev-logs           # æŸ¥çœ‹æ—¥å¿—

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

5ï¸âƒ£ æ•…éšœæ’æŸ¥
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

é—®é¢˜ï¼šå®¹å™¨æ— æ³•å¯åŠ¨
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  1. æŸ¥çœ‹å®¹å™¨æ—¥å¿—
     docker-compose logs backend

  2. æ£€æŸ¥ç«¯å£å ç”¨
     Linux/Mac: netstat -tlnp | grep 8000
     Windows:   netstat -ano | findstr 8000

  3. æ£€æŸ¥ .env é…ç½®
     cat .env

  4. æŸ¥çœ‹å®¹å™¨çŠ¶æ€
     docker-compose ps

é—®é¢˜ï¼šGPU ä¸å¯ç”¨
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  1. æ£€æŸ¥ NVIDIA é©±åŠ¨
     nvidia-smi

  2. æµ‹è¯• Docker GPU æ”¯æŒ
     docker run --rm --gpus all nvidia/cuda:12.6.2-base nvidia-smi

  3. æ£€æŸ¥å®¹å™¨ GPU
     docker-compose exec worker nvidia-smi

é—®é¢˜ï¼šæ¨¡å‹ä¸‹è½½å¤±è´¥
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  1. æ£€æŸ¥ç½‘ç»œè¿æ¥
     docker-compose exec backend curl -I https://huggingface.co

  2. æ‰‹åŠ¨ä¸‹è½½æ¨¡å‹åˆ° models/ ç›®å½•

  3. ä½¿ç”¨å›½å†…é•œåƒï¼ˆModelScopeï¼‰
     # åœ¨ .env ä¸­è®¾ç½®
     USE_MODELSCOPE=true

é—®é¢˜ï¼šå‰ç«¯æ— æ³•è®¿é—®åç«¯
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  1. æ£€æŸ¥ CORS é…ç½®
     # .env
     ALLOWED_ORIGINS=http://localhost:80

  2. æ£€æŸ¥å®¹å™¨ç½‘ç»œ
     docker network inspect tianshu-network

  3. æµ‹è¯• API
     curl http://localhost:8000/health

é—®é¢˜ï¼šæ•°æ®åº“é”™è¯¯
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  1. å¤‡ä»½æ•°æ®åº“
     make backup-db

  2. æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶æƒé™
     ls -l data/db/

  3. é‡æ–°åˆå§‹åŒ–ï¼ˆè­¦å‘Šï¼šä¼šä¸¢å¤±æ•°æ®ï¼‰
     docker-compose down -v
     rm -rf data/db/
     docker-compose up -d

å¸¸ç”¨è°ƒè¯•å‘½ä»¤ï¼š
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨
  docker stats

  # æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯
  docker inspect mineru-backend

  # æŸ¥çœ‹å®¹å™¨ç¯å¢ƒå˜é‡
  docker-compose exec backend env

  # æµ‹è¯•å®¹å™¨é—´ç½‘ç»œ
  docker-compose exec backend ping worker

  # å¼ºåˆ¶é‡å»º
  docker-compose up -d --force-recreate --no-deps backend

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

6ï¸âƒ£ ç”Ÿäº§ç¯å¢ƒå»ºè®®
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

å®‰å…¨é…ç½®ï¼š
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  âœ… ä¿®æ”¹é»˜è®¤ JWT_SECRET_KEY
     # ç”Ÿæˆå¼ºéšæœºå¯†é’¥
     openssl rand -hex 32

  âœ… é™åˆ¶ CORS
     ALLOWED_ORIGINS=https://yourdomain.com

  âœ… ä½¿ç”¨ HTTPS
     # ä½¿ç”¨ Nginx åå‘ä»£ç†æˆ– Traefik

  âœ… å®šæœŸæ›´æ–°é•œåƒ
     docker-compose pull
     docker-compose up -d

æ€§èƒ½ä¼˜åŒ–ï¼š
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  âœ… ä½¿ç”¨ GPUï¼ˆå¿…éœ€ï¼‰
     CUDA_VISIBLE_DEVICES=0,1  # å¤šå¡

  âœ… è°ƒæ•´ Worker é…ç½®
     WORKER_GPUS=2
     MAX_BATCH_SIZE=8

  âœ… èµ„æºé™åˆ¶
     # docker-compose.yml
     deploy:
       resources:
         limits:
           cpus: '4'
           memory: 16G

å¤‡ä»½ç­–ç•¥ï¼š
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  âœ… å®šæœŸå¤‡ä»½æ•°æ®åº“
     make backup-db

  âœ… å¤‡ä»½é‡è¦ç›®å½•
     tar -czf backup.tar.gz data/ models/

  âœ… ä½¿ç”¨ MinIO æˆ– S3 å­˜å‚¨ä¸Šä¼ æ–‡ä»¶
     ENABLE_MINIO=true

ç›‘æ§ï¼š
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  âœ… å¥åº·æ£€æŸ¥
     docker-compose ps | grep "healthy"

  âœ… æ—¥å¿—æ”¶é›†
     # ä½¿ç”¨ ELK Stack æˆ– Loki

  âœ… èµ„æºç›‘æ§
     docker stats

  âœ… Prometheus + Grafana
     ENABLE_METRICS=true

é«˜å¯ç”¨éƒ¨ç½²ï¼š
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â€¢ ä½¿ç”¨ Kubernetes ç¼–æ’
  â€¢ ä½¿ç”¨è´Ÿè½½å‡è¡¡å™¨ï¼ˆNginx/Traefikï¼‰
  â€¢ å¤šå‰¯æœ¬éƒ¨ç½²
  â€¢ ä½¿ç”¨å¤–éƒ¨æ•°æ®åº“ï¼ˆPostgreSQLï¼‰
  â€¢ ä½¿ç”¨å¯¹è±¡å­˜å‚¨ï¼ˆS3/MinIOï¼‰

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“š æ›´å¤šèµ„æº
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

  â€¢ é¡¹ç›®æ–‡æ¡£:      README.md
  â€¢ Docker å‘½ä»¤:   scripts/docker-commands.sh
  â€¢ API æ–‡æ¡£:      http://localhost:8000/docs
  â€¢ é—®é¢˜åé¦ˆ:      GitHub Issues

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ’¡ æç¤ºï¼š
  â€¢ é¦–æ¬¡éƒ¨ç½²å»ºè®®ä½¿ç”¨ make setup ä¸€é”®å®Œæˆ
  â€¢ ç”Ÿäº§ç¯å¢ƒè¯·åŠ¡å¿…ä¿®æ”¹æ‰€æœ‰é»˜è®¤å¯†é’¥
  â€¢ å»ºè®®ä½¿ç”¨ GPU ä»¥è·å¾—æœ€ä½³æ€§èƒ½
  â€¢ å®šæœŸå¤‡ä»½æ•°æ®å’Œæ¨¡å‹æ–‡ä»¶

ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼ ğŸš€
